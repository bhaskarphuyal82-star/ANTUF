# User Profile API - Visual Architecture & Flow Guide

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (Next.js/React)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  Pages:                                                       â”‚
â”‚  â”œâ”€ /dashboard/admin/alluser â†’ UserManagement Component      â”‚
â”‚  â””â”€ /dashboard/profile â†’ User Profile Page (custom)          â”‚
â”‚                                                               â”‚
â”‚  Components:                                                  â”‚
â”‚  â”œâ”€ /components/admin/user/UserManagement.js                 â”‚
â”‚  â”‚   â”œâ”€ User Table                                           â”‚
â”‚  â”‚   â”œâ”€ Search Bar                                           â”‚
â”‚  â”‚   â”œâ”€ Filter Controls                                      â”‚
â”‚  â”‚   â”œâ”€ Edit Dialog                                          â”‚
â”‚  â”‚   â””â”€ Pagination                                           â”‚
â”‚  â””â”€ Custom components (using hooks/API)                      â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ HTTP Requests
             â”‚ (with authentication)
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API Layer (Next.js Route Handlers)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  User Endpoints:                                              â”‚
â”‚  â”œâ”€ GET  /api/user/profile                                  â”‚
â”‚  â””â”€ POST /api/user/profile                                  â”‚
â”‚                                                               â”‚
â”‚  Admin Endpoints:                                             â”‚
â”‚  â”œâ”€ GET    /api/admin/users/profile                         â”‚
â”‚  â”œâ”€ POST   /api/admin/users/profile                         â”‚
â”‚  â”œâ”€ DELETE /api/admin/users/profile                         â”‚
â”‚  â”œâ”€ GET    /api/admin/users/[userId]/profile                â”‚
â”‚  â”œâ”€ PATCH  /api/admin/users/[userId]/profile                â”‚
â”‚  â””â”€ DELETE /api/admin/users/[userId]/profile                â”‚
â”‚                                                               â”‚
â”‚  Authentication Middleware:                                   â”‚
â”‚  â””â”€ NextAuth Session Check (401/403 errors)                 â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ MongoDB Operations
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Database Layer (MongoDB)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  Collections:                                                 â”‚
â”‚  â””â”€ users                                                     â”‚
â”‚     â”œâ”€ name                                                   â”‚
â”‚     â”œâ”€ email (unique)                                         â”‚
â”‚     â”œâ”€ password (hashed with bcrypt)                          â”‚
â”‚     â”œâ”€ image                                                  â”‚
â”‚     â”œâ”€ phone, address, city, state, country, zipCode         â”‚
â”‚     â”œâ”€ bio, motherName, fatherName                           â”‚
â”‚     â”œâ”€ citizenshipNumber, district, etc.                     â”‚
â”‚     â”œâ”€ role (user|admin)                                      â”‚
â”‚     â”œâ”€ isActive                                               â”‚
â”‚     â””â”€ timestamps                                             â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request Flow Diagrams

### User Getting Own Profile
```
User Browser                API Route              Database
    â”‚                          â”‚                       â”‚
    â”œâ”€â”€â”€ GET /api/user/profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”œâ”€ Check Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                          â”‚                       â”‚
    â”‚                          â”œâ”€ Fetch user document  â”‚
    â”‚                   <â”€â”€â”€â”€â”€â”€â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                          â”‚      {user object}     â”‚
    â”‚   <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
    â”‚    {name, email, phone,  â”‚                        â”‚
    â”‚     address, bio, ...}   â”‚                        â”‚
    â”‚                          â”‚                        â”‚
```

### Admin Listing All Users
```
Admin Browser              API Route              Database
    â”‚                         â”‚                       â”‚
    â”œâ”€ GET /api/admin/users/profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚    ?page=1&limit=20                             â”‚
    â”‚    &search=john                                 â”‚
    â”‚    &role=user                                   â”‚
    â”‚                         â”‚                       â”‚
    â”‚                         â”œâ”€ Check Auth (Admin)   â”‚
    â”‚                         â”œâ”€ Build Query â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                         â”‚                       â”‚
    â”‚                         â”œâ”€ Find users â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   <â”€â”€â”€â”€â”€â”€â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                         â”‚  [{user1}, {user2}...] â”‚
    â”‚   <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
    â”‚    {                     â”‚                        â”‚
    â”‚      success: true,      â”‚                        â”‚
    â”‚      data: [...],        â”‚                        â”‚
    â”‚      pagination: {...}   â”‚                        â”‚
    â”‚    }                     â”‚                        â”‚
    â”‚                         â”‚                        â”‚
```

### Admin Updating User
```
Admin Browser              API Route              Database
    â”‚                         â”‚                       â”‚
    â”œâ”€ PATCH /api/admin/users/USER_ID/profile â”€â”€â”€â”€â”€â”€>â”‚
    â”‚    {name, role, isActive}                       â”‚
    â”‚                         â”‚                       â”‚
    â”‚                         â”œâ”€ Check Auth (Admin)   â”‚
    â”‚                         â”œâ”€ Validate fields      â”‚
    â”‚                         â”œâ”€ Update document â”€â”€â”€â”€>â”‚
    â”‚                   <â”€â”€â”€â”€â”€â”€â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                         â”‚  {updated user}        â”‚
    â”‚   <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
    â”‚    {                     â”‚                        â”‚
    â”‚      success: true,      â”‚                        â”‚
    â”‚      msg: "Updated",     â”‚                        â”‚
    â”‚      data: {...}         â”‚                        â”‚
    â”‚    }                     â”‚                        â”‚
    â”‚                         â”‚                        â”‚
```

---

## ğŸ“Š Data Flow - User Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Start: User Accesses Admin Page                 â”‚
â”‚         /dashboard/admin/alluser                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ UserManagement        â”‚
         â”‚ Component Loads       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ useEffect Triggers    â”‚
         â”‚ fetchUsers()          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ GET /api/admin/users/profile                  â”‚
         â”‚ ?page=1&limit=20                             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚
    â–¼             â–¼             â–¼
  Success      Error         Loading
    â”‚             â”‚             â”‚
    â”œâ”€â”€> Display  â”œâ”€â”€> Show    â”œâ”€â”€> Show
    â”‚   Users     â”‚   Error    â”‚   Loading
    â”‚   Table     â”‚   Alert    â”‚   Spinner
    â”‚             â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
           â”‚                     â”‚
           â–¼                     â”‚
    User Actions:               â”‚
    â”œâ”€ Click Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€> New Fetch with ?search=...
    â”œâ”€ Filter Role  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€> New Fetch with ?role=...
    â”œâ”€ Filter Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€> New Fetch with ?isActive=...
    â”œâ”€ Change Page  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€> New Fetch with ?page=...
    â”œâ”€ Click Edit   â”€â”€â”€â”€â”
    â”‚                   â”œâ”€â”€> Open Edit Dialog
    â”‚                   â”‚    (pre-fill form with user data)
    â”‚                   â”‚
    â”‚                   â”œâ”€â”€> User Makes Changes
    â”‚                   â”‚
    â”‚                   â”œâ”€â”€> Click Save
    â”‚                   â”‚
    â”‚                   â–¼
    â”‚            PATCH /api/admin/users/USER_ID/profile
    â”‚            (with updated fields)
    â”‚                   â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
    â”‚            â”‚             â”‚
    â”‚         Success      Error
    â”‚            â”‚             â”‚
    â”‚            â”œâ”€â”€> Refresh  â”œâ”€â”€> Show Error
    â”‚            â”‚   Table     â”‚   Alert
    â”‚            â”‚             â”‚
    â”œâ”€ Click Delete â”€â”€â”€â”€â”
    â”‚                   â”œâ”€â”€> Show Confirmation
    â”‚                   â”‚
    â”‚                   â”œâ”€â”€> User Confirms
    â”‚                   â”‚
    â”‚                   â–¼
    â”‚            DELETE /api/admin/users/USER_ID/profile
    â”‚                   â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
    â”‚            â”‚             â”‚
    â”‚         Success      Error
    â”‚            â”‚             â”‚
    â”‚            â”œâ”€â”€> Remove   â”œâ”€â”€> Show Error
    â”‚            â”‚   from      â”‚   Alert
    â”‚            â”‚   table     â”‚
    â”‚            â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authentication & Authorization Flow

```
Request Comes In
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check for NextAuth Session              â”‚
â”‚ (from cookies)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
  Valid    Invalid
   â”‚         â”‚
   â”‚         â””â”€â”€> Return 401 Unauthorized
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Is it an Admin Endpoint?                â”‚
â”‚ (/api/admin/*)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
   No        Yes
    â”‚         â”‚
    â–¼         â–¼
  Allow    Check if User
  (User    has role="admin"
  endpoints) or isAdmin=true
    â”‚         â”‚
    â”‚     â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â”‚     â”‚       â”‚
    â”‚    Yes      No
    â”‚     â”‚       â”‚
    â”‚     â–¼       â””â”€â”€> Return 403 Forbidden
    â”‚     â”‚
    â””â”€â”€â”€â”€â”€â”¼â”€â”€> Process Request
          â”‚
          â–¼
    Execute Logic
          â”‚
          â–¼
    Return Response (200/400/404/500)
```

---

## ğŸ¨ Component Hierarchy

```
Pages/
â”œâ”€â”€ /dashboard/admin/alluser/page.js
â”‚   â”‚
â”‚   â””â”€â”€ <UserManagement>
â”‚       â”œâ”€â”€ Header (Title + Refresh Button)
â”‚       â”‚
â”‚       â”œâ”€â”€ Search & Filter Section
â”‚       â”‚   â”œâ”€â”€ <TextField> Search Input
â”‚       â”‚   â”œâ”€â”€ <Select> Role Filter
â”‚       â”‚   â””â”€â”€ <Select> Status Filter
â”‚       â”‚
â”‚       â”œâ”€â”€ User Table
â”‚       â”‚   â”œâ”€â”€ <TableContainer>
â”‚       â”‚   â”œâ”€â”€ <TableHead>
â”‚       â”‚   â”‚   â””â”€â”€ Column Headers
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ <TableBody>
â”‚       â”‚       â””â”€â”€ <TableRow> (for each user)
â”‚       â”‚           â”œâ”€â”€ <Avatar> (with fallback initials)
â”‚       â”‚           â”œâ”€â”€ Name
â”‚       â”‚           â”œâ”€â”€ Email
â”‚       â”‚           â”œâ”€â”€ Phone
â”‚       â”‚           â”œâ”€â”€ City
â”‚       â”‚           â”œâ”€â”€ Role <Chip>
â”‚       â”‚           â”œâ”€â”€ Status <Chip>
â”‚       â”‚           â””â”€â”€ Actions
â”‚       â”‚               â”œâ”€â”€ Edit <Button>
â”‚       â”‚               â””â”€â”€ Delete <Button>
â”‚       â”‚
â”‚       â”œâ”€â”€ Pagination Controls
â”‚       â”‚   â””â”€â”€ <Pagination>
â”‚       â”‚
â”‚       â””â”€â”€ Edit Dialog
â”‚           â”œâ”€â”€ <Dialog>
â”‚           â”œâ”€â”€ <DialogTitle>
â”‚           â”œâ”€â”€ <DialogContent>
â”‚           â”‚   â”œâ”€â”€ <TextField> Name
â”‚           â”‚   â”œâ”€â”€ <TextField> Email
â”‚           â”‚   â”œâ”€â”€ <TextField> Phone
â”‚           â”‚   â”œâ”€â”€ <TextField> City
â”‚           â”‚   â”œâ”€â”€ <TextField> State
â”‚           â”‚   â”œâ”€â”€ <TextField> Country
â”‚           â”‚   â”œâ”€â”€ <TextField> Bio
â”‚           â”‚   â”œâ”€â”€ <Select> Role
â”‚           â”‚   â””â”€â”€ <Select> Status
â”‚           â”‚
â”‚           â””â”€â”€ <DialogActions>
â”‚               â”œâ”€â”€ Cancel <Button>
â”‚               â””â”€â”€ Save <Button>
```

---

## ğŸ“ˆ Data Processing Pipeline

```
Raw Request Input
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validate Input Data     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Check required fields â”‚
â”‚ â€¢ Validate formats      â”‚
â”‚ â€¢ Check constraints     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
  Valid    Invalid
    â”‚         â”‚
    â–¼         â””â”€â”€> Return 400 Bad Request
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Process Data            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Hash passwords        â”‚
â”‚ â€¢ Filter image URLs     â”‚
â”‚ â€¢ Trim strings          â”‚
â”‚ â€¢ Convert types         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database Operation      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Find documents        â”‚
â”‚ â€¢ Update documents      â”‚
â”‚ â€¢ Delete documents      â”‚
â”‚ â€¢ Apply indexes         â”‚
â”‚ â€¢ Check uniqueness      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
  Success  Error
    â”‚         â”‚
    â–¼         â””â”€â”€> Return 500 Server Error
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Format Response Data    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Remove sensitive data â”‚
â”‚ â€¢ Add pagination info   â”‚
â”‚ â€¢ Include success flag  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    JSON Response
    (to client)
```

---

## ğŸ” Search & Filter Flow

```
User Enters Search Term "john"
    â”‚
    â–¼
Trigger handleSearch()
    â”‚
    â–¼
Build Query String:
"?page=1&limit=20&search=john&role=user&isActive=true"
    â”‚
    â–¼
Fetch /api/admin/users/profile?...
    â”‚
    â–¼
Server Receives Request
    â”‚
    â–¼
Build MongoDB Query:
{
  $or: [
    { name: { $regex: "john", $options: "i" } },
    { email: { $regex: "john", $options: "i" } }
  ],
  role: "user",
  isActive: true
}
    â”‚
    â–¼
Apply Query to Database
    â”‚
    â–¼
Get Matching Documents
    â”‚
    â–¼
Apply Pagination:
skip((page-1)*limit).limit(limit)
    â”‚
    â–¼
Format Response with:
â€¢ data: [users]
â€¢ pagination: {total, pages, hasMore}
    â”‚
    â–¼
Return to Client
    â”‚
    â–¼
Display Results in Table
```

---

## ğŸ­ Error Handling Flow

```
API Request
    â”‚
    â–¼
Try Block
    â”‚
    â”œâ”€â–º Authorization Check
    â”‚   â”œâ”€â–º Failed? â”€â”€> 401 Unauthorized
    â”‚   â””â”€â–º Failed? â”€â”€> 403 Forbidden
    â”‚
    â”œâ”€â–º Validation
    â”‚   â”œâ”€â–º Failed? â”€â”€> 400 Bad Request
    â”‚
    â”œâ”€â–º Database Operation
    â”‚   â”œâ”€â–º Failed? â”€â”€> 404 Not Found
    â”‚   â”œâ”€â–º Failed? â”€â”€> 500 Server Error
    â”‚
    â””â”€â–º Success â”€â”€> 200 OK / 201 Created
           â”‚
           â–¼
    Return Response
    â”‚
    â–¼
Catch Error
    â”‚
    â”œâ”€â–º Log to Console
    â”œâ”€â–º Format Error Message
    â””â”€â–º Return 500 Error Response
           â”‚
           â–¼
    Client Receives Error
    â”‚
    â–¼
Frontend Handler
    â”‚
    â”œâ”€â–º Show Error Alert
    â”œâ”€â–º Log to Console
    â””â”€â–º Allow User Retry
```

---

## ğŸŒ API Endpoint Mapping

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          USER ENDPOINTS (Authenticated Users)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  GET /api/user/profile                                   â”‚
â”‚  â””â”€ Fetch: Own profile or other (if admin)               â”‚
â”‚                                                            â”‚
â”‚  POST /api/user/profile                                  â”‚
â”‚  â””â”€ Update: Own profile or other (if admin)              â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ADMIN ENDPOINTS (Admin Users Only)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  GET /api/admin/users/profile                            â”‚
â”‚  â”œâ”€ List all users                                       â”‚
â”‚  â”œâ”€ Supports: page, limit, search, role, isActive        â”‚
â”‚  â””â”€ Returns: {data: [...], pagination: {...}}            â”‚
â”‚                                                            â”‚
â”‚  POST /api/admin/users/profile                           â”‚
â”‚  â””â”€ Update user (bulk operation)                         â”‚
â”‚                                                            â”‚
â”‚  DELETE /api/admin/users/profile                         â”‚
â”‚  â”œâ”€ Delete user                                          â”‚
â”‚  â””â”€ Requires: ?userId=...                                â”‚
â”‚                                                            â”‚
â”‚  GET /api/admin/users/[userId]/profile                   â”‚
â”‚  â””â”€ Get specific user details                            â”‚
â”‚                                                            â”‚
â”‚  PATCH /api/admin/users/[userId]/profile                 â”‚
â”‚  â””â”€ Update specific user                                 â”‚
â”‚                                                            â”‚
â”‚  DELETE /api/admin/users/[userId]/profile                â”‚
â”‚  â””â”€ Delete specific user                                 â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Mobile Responsive Design

```
Desktop Layout
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header | Search | Filters           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚Profileâ”‚Name  â”‚Email â”‚Cityâ”‚Actionsâ”‚ â† Columns
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚Avatar â”‚John  â”‚john@ â”‚NYC â”‚ âœ âœ—  â”‚
â”‚ â”‚       â”‚      â”‚      â”‚    â”‚      â”‚
â”‚ â”‚Avatar â”‚Jane  â”‚jane@ â”‚LA  â”‚ âœ âœ—  â”‚
â”‚ â”‚       â”‚      â”‚      â”‚    â”‚      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pagination: 1 2 3 4 5 ... 10       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Mobile Layout (xs)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search Bar       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Filters (stack)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cards Layout:    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Avatar Name  â”‚ â”‚
â”‚ â”‚ Email        â”‚ â”‚
â”‚ â”‚ City         â”‚ â”‚
â”‚ â”‚ [Edit][Del]  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Avatar Name  â”‚ â”‚
â”‚ â”‚ Email        â”‚ â”‚
â”‚ â”‚ City         â”‚ â”‚
â”‚ â”‚ [Edit][Del]  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pagination      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tablet Layout (sm/md)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search     â”‚ Filters          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚Avatarâ”‚Nameâ”‚Emailâ”‚Cityâ”‚Act.â”‚ â† Condensed
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”‚      â”‚Johnâ”‚john@â”‚NYC â”‚ âœâœ— â”‚
â”‚ â”‚      â”‚Janeâ”‚jane@â”‚LA  â”‚ âœâœ— â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pagination                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Key Takeaways:**
- ğŸ¯ **8 Endpoints** for complete user management
- ğŸ” **Authentication & Authorization** on all endpoints
- ğŸ” **Search, Filter, Paginate** for large datasets
- âš¡ **Fast Response Times** with indexed queries
- ğŸ¨ **Responsive UI** for all screen sizes
- âœ… **Error Handling** at every level
- ğŸ“Š **Scalable Architecture** ready for growth
